#!/usr/bin/env sh
main() {
  local MODIFIER_ON=0 OPTSTR='@'
  for i in {{a..z},{A..Z}}; do OPTSTR+=$i; done
  while getopts $OPTSTR opt; do
    case $opt in
      @) MODIFIER_ON=1;;
      a) rofi -no-lazy-grab -show drun -theme ~/.config/rofi/themes/launcher.rasi;;
      f) bspc desktop -l next;;
      q) ctrl 'xdo close' 'xdo kill'; quit_monocle;;
      r) rofi -no-lazy-grab -show run -theme ~/.config/rofi/themes/dmenu.rasi;;
      t) quit_monocle; exec alacritty;;
      v) floatwin term lfrun 1920x2160+0+0;;
      w) quit_monocle; ctrl "bravectl start" "bravectl start_inco";;
      x) multilockscreen -s;;
      C) click;;
      D) bravectl start_dev;;
      E) run-emacs;;
      F) exec floatwin mpv;;
      M) floatwin term ncmpcpp 1500x600+10+60;;
      N) nautilus;;
      S) flameshot full -p ~/pictures/screenshots;;
      T) ~/.config/rofi/scripts/sessions;;
      \?) exit 1;;
    esac
  done;
  shift $((OPTIND -1))
}

quit_monocle() { [[ $(bspc wm -g | awk -F ':' '{print $(NF-2)}') == 'LM' ]] && bspc desktop -l next; }
ctrl() { [[ $MODIFIER_ON == "0" ]] && eval $1 || eval $2; }
click() { sleep 0.2 && xdotool click 1; }
run_emacs() { wid=$(xdotool search --class 'emacs'); [[ -n $wid ]] && xdotool windowactivate $wid || exec emacs; }

main $@
