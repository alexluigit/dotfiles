#!/usr/bin/env bash
export FIFO_UEBERZUG="/tmp/lf-ueberzug-${PPID}"

cleanup() {
  sleep .02 # Wait lf run 'cleaner' first
	rm "$FIFO_UEBERZUG" 2>/dev/null
	pkill -KILL -P $$
}

# cleanup
mkfifo "$FIFO_UEBERZUG" 2>/dev/null
trap cleanup EXIT
tail --follow "$FIFO_UEBERZUG" | ueberzug layer --silent --parser bash 2>&1 >/dev/null &

# ~/.local/share/go/bin/lf $@
lf $@
