#!/bin/sh
add() {
  local nvimPath='config/nvim/pack/bundle/opt'
  local zshPath='config/zsh/plugins'
  local binPath='local/bin'
  local mName=$(sed 's|.*/||' <<< "$1")
  echo "1) nvim -> $nvimPath/$mName"
  echo "2) zsh  -> $zshPath/$mName"
  echo "3) bin  -> $binPath/$mName"
  echo "4) Type manually"
  read -p "Please choose target directory : " REPLY
  case $REPLY in
    1) iPath=$nvimPath;;
    2) iPath=$zshPath;;
    3) iPath=$binPath;;
    4) read -p "Input directory: " iPath;;
    *) echo "Invalid option. Exit" && exit 1;;
  esac
  echo "Installing to $iPath/$mName"
  git submodule add --name $mName $1 $iPath/$mName
}

remove() {
  local mPath=$(git submodule | grep "$1" | awk '{print $2}')
  [[ $(echo "$mPath" | wc -l) -gt 1 ]] && echo "More than 1 match" && echo $mPath && exit 1
  local mName=$(sed 's|.*/||' <<< "$mPath")
  git submodule deinit -f "$mPath" && git rm -f "$mPath" && rm -rf ".git/modules/$mName"
}

update() {
  local mPath=$(git submodule | grep "$1" | awk '{print $2}')
  [[ $(echo "$mPath" | wc -l) -gt 1 ]] && echo "More than 1 match" && echo $mPath && exit 1
  git submodule update --recursive --remote $mPath
}

updateall() {
  git submodule update --recursive --remote
}

"$@"
