#!/usr/bin/env sh
main() {
  local MODIFIER_ON=0 OPTSTR='@%:'
  while getopts $OPTSTR opt; do
    case $opt in
      @) MODIFIER_ON=1;;
      %) case $OPTARG in
          Delete) send_key "\[F12]";;
          Escape) ~/.config/rofi/scripts/powermenu;;
          F10) volumectl mute;;
          F11) volumectl down;;
          F12) volumectl up;;
          F3fix) f3fix;;
          F7) exec music-control previous;;
          F8) exec music-control play-pause;;
          F9) exec music-control next;;
          Return) exec floatwin -t -d 1200x2090+10+60;;
          mouse1) send_key "\Cx";;
          mouse2) send_key "\Aa";;
          *) exit;;
         esac;;
      \?) exit 1;;
    esac
  done;
  shift $((OPTIND -1))
}

f3fix() { [[ $(__focus_wclass) = *"Brave"* ]] && send_key "\Co" || send_key "\[F3]"; }
ctrl() { [[ $MODIFIER_ON == "0" ]] && eval $1 || eval $2; }
send_key() { xvkbd -xsendevent -text $1; }
__focus_wname() { xdotool getwindowfocus getwindowname; }
__focus_wclass() { xprop -id $(xdotool getwindowfocus) WM_CLASS | cut -d '"' -f 4; }
main $@
